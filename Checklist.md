### Введение в проект.

1. Проверить хэш-сумму и убедиться, что они одинаковые.
2. Объяснить как работают виртуальные машины.
    
    [Как работают виртуальные машины.](https://www.notion.so/351cd7697a234e509ac011fce962240d)
    
3. Выбор операционной системы.
4. Рассказать про базовые отличия CentOS и Debian.
    
    [Отличия CentOS и Debian.](https://www.notion.so/CentOS-Debian-465db1d0a73649a091ccb4ab6521491b)
    
5. Рассказать цели использования виртуальных машин.
    
    [Цели использования виртуальных машин.](https://www.notion.so/f254cb8c7237410985430579811424d1)
    
6. Рассказать про aptitude, apt и APPArmor.
    
    [Aptitude, apt и  APPArmor.](https://www.notion.so/Aptitude-apt-APPArmor-5383e07f23a64f98a6facebb944c16c0)
    
7. Во время защиты, cron должен выполнять скрипт каждые 10 минут.

### Установка.

1. Проверить, что на виртуальной машине не установлена графическая оболочка.
    
    ```
    # apt purge xorg
    ```
    
2. Перед подключением к этой машине запрашивается пароль.
3. Войти в учетную запись. Учётная запись не должна быть root. Обратить внимание на выбранный пароль. Пароль должен соответствовать политике, которая описана в задании.
4. Проверить, что UFW запущен.
    
    Проверить UFW: 
    
    ```
    # service ufw status
    ```
    
5. Проверить, что SSH запущен.
    
    Проверить SSH: 
    
    ```
    # service ssh status
    ```
    
6. Проверить выбранную операционную систему.
    
    Проверить информацию о системе: 
    
    ```
    # uname -a
    ```
    

### Пользователи.

1. В виртуальной машине должен быть пользователь с именем в качестве логина проверяемого. Проверить, что он существует и добавлен в группы «sudo» и «user42».
    
    Проверить, что пользователь с таким именем существует:
    
    ```
     # who
    ```
    
    Или:
    
    ```
    # cat /etc/passwd
    ```
    
    Проверить, что пользователь добавлен в группы «sudo» и «user42»: 
    
    ```
    # groups <username>
    ```
    
2. Проверить, что политика паролей установлена с помощью следующих шагов.
    
    Сначала создать нового пользователя. Затем задать пароль по выбору. Проверяющий должен объяснить, как он задал политику паролей из задания. Проверяемый должен сделать несколько модификаций файла.
    
    Создать нового пользователя с домашней директорией:  
    
    ```
    # adduser <username>
    ```
    
    Задать пароль:
    
    ```
    # passwd <username>
    ```
    
    [Как задать политику паролей.](https://www.notion.so/313edde4fdda4598850032d831a736ae)
    
3. Создать новую группу «evaluating» и добавить туда пользователя, которого мы создали ранее. Убедиться, что пользователь добавлен в группу.
    
    Создать новую группу:
    
    ```
    # groupadd <groupname>
    ```
    
    Добавить пользователя в группу:
    
    ```
    # usermod -aG <group_to_add> <username>
    ```
    
    Флаг `-a` указывает команде `usermod` на добавление пользователя в группу.
    Флаг `-G` указывает имя вторичной группы, в которую вы хотите добавить пользователя.
    
    Проверить группы пользователя:
    
    ```
    # groups <username>
    ```
    
4. Рассказать о преимуществах политики паролей. 

### Имя хоста и разделы.

1. Проверить, что имя хоста — это логин проверяемого с окончанием 42.
    
    Проверить имя хоста:
    
    ```
    # hostname
    ```
    
2. Изменить имя хоста на логин проверяющего и перезагрузить виртуальную машину. После перезагрузки имя хоста должно быть обновлено.
    
    Изменить имя хоста в двух файлах:
    
    ```
    # nano /etc/hosts
    # nano /etc/hostname
    ```
    
    Перезагрузить виртуальную машину:
    
    ```
    # sudo reboot
    ```
    
3. Можно вернуть прежнее имя хоста.
4. Показать разметку дисков виртуальной машины и сравнить с примером в задании. Рассказать про LVM.
    
    Посмотреть разметку:
    
    ```
    # lsblk
    ```
    
    [LVM и что означают разделы дисков.](https://www.notion.so/LVM-cddb1e38658543fa957db1f1d1c81cba)
    

### Sudo.

1. Проверить, что sudo установлено в системе.
    
    Посмотреть установленные программы и вывести sudo:
    
    ```
    # apt list --installed | grep "sudo" ****
    ```
    
2. Добавить ранее созданного пользователя в группу «sudo».
    
    Добавить пользователя в группу sudo:
    
    ```
    # usermod -aG sudo <username>
    ```
    
3. Добавить пользователя в файле `/etc/sudoers` после `%sudo ALL=(ALL:ALL) ALL`.
    
    ![Screen Shot 2021-12-01 at 9.23.33 PM.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f12203ed-1e0d-49d1-ab92-22dff1d12d70/Screen_Shot_2021-12-01_at_9.23.33_PM.png)
    
4. Перезагрузить виртуальную машину.
5. Показать пример команды с помощью sudo.
6. Проверить, что конфигурация sudo работает так, как указано в задании.
    
    Запрос sudo ограничено 3 попытками при неправильном пароле. Каждое использование sudo должно регистрировать и сохраняться в файле. Должны сохраняться запросы sudo и выполнение команды с помощью sudo. Файл с логом должен сохраняться в `/var/log/sudo/`. Режим TTY включен. Пути использования sudo ограничены. Например: `/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin`.
    
    [Как настроить sudo и что такое TTY.](https://www.notion.so/sudo-TTY-c0710c78bad04ca7aa52564dc3986a53)
    
7. Проверить, что после использования sudo, лог-файлы обновились:
    
    ```
    # cat /var/log/sudo/sudo.log
    ```
    

### UFW.

1. Проверить, что UFW установлен:
    
    ```
    # apt list --installed | grep "ufw"
    ```
    
2. Показать, что он работает должным образом. Для этого попробовать подключиться по запрещённому порту.
3. Отобразить все активные правила в UFW. Он должен содержать правило для порта 4242.
    
    ```
    # ufw status
    ```
    
4. Добавить новое правило для открытия порта 8080:
    
    ```
    # ufw allow 8080
    ```
    
5. Удалить это правило:
    
    ```
    # ufw deny 8080
    # sudo ufw status numbered
    $ sudo ufw delete <number>
    ```
    

### SSH.

1. Проверить, что SSH установлен:
    
    ```
    # service ssh status
    ```
    
2. Показать, что он работает правильно. Войти через терминал:
    
    ```
    # ssh <username>@localhost -p 4242
    ```
    
3. Убедиться, что SSH использует только порт 4242:
    
    ```
    # nano /etc/ssh/sshd_config
    ```
    
4. Зайти через SSH под ранее созданного пользователя.
5. Убедиться невозможно использовать SSH с пользователем «root».

[Как настроить SSH.](https://www.notion.so/SSH-908e6749b44c472cb0f8d5e85ff7da85)

### Скрипт.

1. Показать скрипт и рассказать, как он работает.
    
    [Как работает скрипт.](https://www.notion.so/8659501fb5a64f63a44576038ac783ba)
    
2. Объяснить, что такое cron.
3. Объяснить, каким образом скрипт запускается каждые 10 минут.
    
    ```
    # crontab -e
    ```
    
4. Сделать так, чтобы скрипт запускался каждые 30 секунд.
5. Сделать так, чтобы скрипт не запускался. Сам скрипт менять нельзя.
6. Проверить, что скрипт существует и он не изменён.

### Бонусы.

1. Проверить, что разметка дисков установлена по заданию.
    
    ```
    # lsblk
    ```
    
2. Проверить, что установлен сайт на Wordpress с lighttpd, MariaDB и PHP.
3. Проверить, что есть дополнительный сервис. Объяснить, как он работает.
4. Проверить, что NGINX и Apache2 не установлены:
    
    ```
    # apt purge apache2
    # apt purge nginx
    ```
